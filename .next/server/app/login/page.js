(()=>{var e={};e.id=4520,e.ids=[4520],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},19169:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("Mail",[["rect",{width:"20",height:"16",x:"2",y:"4",rx:"2",key:"18n3k1"}],["path",{d:"m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7",key:"1ocrg3"}]])},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},39390:(e,t,r)=>{"use strict";r.d(t,{J:()=>d});var s=r(60687),a=r(43210),i=r(78148),n=r(24224),o=r(96241);let l=(0,n.F)("text-sm font-medium leading-none peer-disabled:cursor-not-allowed peer-disabled:opacity-70"),d=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)(i.b,{ref:r,className:(0,o.cn)(l(),e),...t}));d.displayName=i.b.displayName},46387:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>s});let s=(0,r(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\Project\\\\frontend\\\\app\\\\login\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\Project\\frontend\\app\\login\\page.tsx","default")},52818:(e,t,r)=>{"use strict";r.r(t),r.d(t,{GlobalError:()=>n.a,__next_app__:()=>u,pages:()=>c,routeModule:()=>m,tree:()=>d});var s=r(65239),a=r(48088),i=r(88170),n=r.n(i),o=r(30893),l={};for(let e in o)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(l[e]=()=>o[e]);r.d(t,l);let d={children:["",{children:["login",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(r.bind(r,46387)),"D:\\Project\\frontend\\app\\login\\page.tsx"]}]},{}]},{layout:[()=>Promise.resolve().then(r.bind(r,58014)),"D:\\Project\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(r.t.bind(r,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(r.t.bind(r,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(r.t.bind(r,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,c=["D:\\Project\\frontend\\app\\login\\page.tsx"],u={require:r,loadChunk:()=>Promise.resolve()},m=new s.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/login/page",pathname:"/login",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:d}})},55192:(e,t,r)=>{"use strict";r.d(t,{BT:()=>d,Wu:()=>c,ZB:()=>l,Zp:()=>n,aR:()=>o});var s=r(60687),a=r(43210),i=r(96241);let n=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,i.cn)("rounded-lg border bg-card text-card-foreground shadow-sm",e),...t}));n.displayName="Card";let o=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,i.cn)("flex flex-col space-y-1.5 p-6",e),...t}));o.displayName="CardHeader";let l=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,i.cn)("text-2xl font-semibold leading-none tracking-tight",e),...t}));l.displayName="CardTitle";let d=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,i.cn)("text-sm text-muted-foreground",e),...t}));d.displayName="CardDescription";let c=a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,i.cn)("p-6 pt-0",e),...t}));c.displayName="CardContent",a.forwardRef(({className:e,...t},r)=>(0,s.jsx)("div",{ref:r,className:(0,i.cn)("flex items-center p-6 pt-0",e),...t})).displayName="CardFooter"},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},57880:(e,t,r)=>{Promise.resolve().then(r.bind(r,46387))},58552:(e,t,r)=>{Promise.resolve().then(r.bind(r,86143))},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},74075:e=>{"use strict";e.exports=require("zlib")},78148:(e,t,r)=>{"use strict";r.d(t,{b:()=>o});var s=r(43210),a=r(14163),i=r(60687),n=s.forwardRef((e,t)=>(0,i.jsx)(a.sG.label,{...e,ref:t,onMouseDown:t=>{t.target.closest("button, input, select, textarea")||(e.onMouseDown?.(t),!t.defaultPrevented&&t.detail>1&&t.preventDefault())}}));n.displayName="Label";var o=n},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},86143:(e,t,r)=>{"use strict";r.r(t),r.d(t,{default:()=>g});var s=r(60687),a=r(43210),i=r(16189),n=r(24934),o=r(68988),l=r(39390),d=r(55192),c=r(71702),u=r(99891),m=r(41862),p=r(19169);let x=(0,r(62688).A)("ArrowRight",[["path",{d:"M5 12h14",key:"1ays0h"}],["path",{d:"m12 5 7 7-7 7",key:"xquz4c"}]]);var h=r(31189);function f({onLoginSuccess:e}){let[t,r]=(0,a.useState)("email"),[i,f]=(0,a.useState)(""),[g,v]=(0,a.useState)(""),[y,j]=(0,a.useState)(""),[b,N]=(0,a.useState)(!1),[w,P]=(0,a.useState)(!1),{toast:k}=(0,c.dj)(),C=async e=>{if(e.preventDefault(),i){N(!0);try{await h.Z.requestOTP({email:i,name:g}),P(!0),r("otp"),k({title:"OTP Sent",description:"Please check your email for the verification code."})}catch(e){k({title:"Error",description:e.response?.data?.error||"Failed to send OTP",variant:"destructive"})}finally{N(!1)}}},q=async t=>{if(t.preventDefault(),i&&y){N(!0);try{let t=await h.Z.verifyOTP({email:i,otp:y,name:g});if(console.log("OTP verification response:",t),"admin"!==t.user.role&&"teacher"!==t.user.role){k({title:"Access Denied",description:"Only administrators can access this dashboard.",variant:"destructive"}),N(!1);return}localStorage.setItem("token",t.token),localStorage.setItem("user",JSON.stringify(t.user)),document.cookie=`token=${t.token}; max-age=3600; path=/;  samesite=strict`,console.log("Stored token:",localStorage.getItem("token")),console.log("Stored user:",localStorage.getItem("user")),k({title:"Login Successful",description:`Welcome back, ${t.user.name}!`}),e()}catch(e){k({title:"Error",description:e.response?.data?.error||"Failed to verify OTP",variant:"destructive"})}finally{N(!1)}}},S=async()=>{N(!0);try{await h.Z.requestOTP({email:i,name:g}),k({title:"OTP Resent",description:"A new verification code has been sent to your email."})}catch(e){k({title:"Error",description:"Failed to resend OTP. Please try again.",variant:"destructive"})}finally{N(!1)}};return(0,s.jsxs)(d.Zp,{className:"w-full max-w-md",children:[(0,s.jsxs)(d.aR,{className:"space-y-1",children:[(0,s.jsx)("div",{className:"flex items-center justify-center mb-4",children:(0,s.jsx)("div",{className:"flex items-center justify-center w-12 h-12 rounded-lg bg-primary text-primary-foreground",children:(0,s.jsx)(u.A,{className:"w-6 h-6"})})}),(0,s.jsx)(d.ZB,{className:"text-2xl text-center",children:"Admin Login"}),(0,s.jsx)(d.BT,{className:"text-center",children:"email"===t?"Enter your admin email to receive a verification code":"Enter the 6-digit code sent to your email"})]}),(0,s.jsxs)(d.Wu,{className:"space-y-4",children:["email"===t?(0,s.jsxs)("form",{onSubmit:C,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.J,{htmlFor:"name",children:"Full Name"}),(0,s.jsx)(o.p,{id:"name",type:"text",placeholder:"Enter your full name",value:g,onChange:e=>v(e.target.value),required:!0})]}),(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.J,{htmlFor:"email",children:"Admin Email"}),(0,s.jsx)(o.p,{id:"email",type:"email",placeholder:"admin@example.com",value:i,onChange:e=>f(e.target.value),required:!0})]}),(0,s.jsx)(n.$,{type:"submit",className:"w-full",disabled:b,children:b?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Sending OTP..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(p.A,{className:"mr-2 h-4 w-4"}),"Send Verification Code"]})})]}):(0,s.jsxs)("form",{onSubmit:q,className:"space-y-4",children:[(0,s.jsxs)("div",{className:"space-y-2",children:[(0,s.jsx)(l.J,{htmlFor:"otp",children:"Verification Code"}),(0,s.jsx)(o.p,{id:"otp",type:"text",placeholder:"Enter 6-digit code",value:y,onChange:e=>j(e.target.value.replace(/\D/g,"").slice(0,6)),maxLength:6,className:"text-center text-lg tracking-widest",required:!0}),(0,s.jsxs)("div",{className:"text-sm text-muted-foreground text-center",children:["Code sent to: ",(0,s.jsx)("span",{className:"font-medium",children:i})]})]}),(0,s.jsx)(n.$,{type:"submit",className:"w-full",disabled:b||6!==y.length,children:b?(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(m.A,{className:"mr-2 h-4 w-4 animate-spin"}),"Verifying..."]}):(0,s.jsxs)(s.Fragment,{children:[(0,s.jsx)(x,{className:"mr-2 h-4 w-4"}),"Verify & Login"]})}),(0,s.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,s.jsx)(n.$,{type:"button",variant:"ghost",onClick:()=>{r("email"),j(""),P(!1)},className:"p-0 h-auto",children:"‚Üê Back to email"}),(0,s.jsx)(n.$,{type:"button",variant:"ghost",onClick:S,disabled:b,className:"p-0 h-auto",children:"Resend Code"})]})]}),(0,s.jsx)("div",{className:"text-xs text-center text-muted-foreground mt-4",children:"Only administrators can access this dashboard. If you don't have admin access, please contact your system administrator."})]})]})}function g(){let e=(0,i.useRouter)(),[t,r]=(0,a.useState)(!0);return t?(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-background",children:(0,s.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,s.jsx)(m.A,{className:"h-6 w-6 animate-spin"}),(0,s.jsx)("span",{children:"Checking authentication..."})]})}):(0,s.jsx)("div",{className:"min-h-screen flex items-center justify-center bg-gradient-to-br from-background to-muted/20 p-4",children:(0,s.jsx)("div",{className:"w-full max-w-md",children:(0,s.jsx)(f,{onLoginSuccess:()=>{console.log("Login success, redirecting to dashboard"),e.push("/dashboard")}})})})}},94735:e=>{"use strict";e.exports=require("events")},99891:(e,t,r)=>{"use strict";r.d(t,{A:()=>s});let s=(0,r(62688).A)("Shield",[["path",{d:"M20 13c0 5-3.5 7.5-7.66 8.95a1 1 0 0 1-.67-.01C7.5 20.5 4 18 4 13V6a1 1 0 0 1 1-1c2 0 4.5-1.2 6.24-2.72a1.17 1.17 0 0 1 1.52 0C14.51 3.81 17 5 19 5a1 1 0 0 1 1 1z",key:"oel41y"}]])}};var t=require("../../webpack-runtime.js");t.C(e);var r=e=>t(t.s=e),s=t.X(0,[4447,1195,8405,4802],()=>r(52818));module.exports=s})();