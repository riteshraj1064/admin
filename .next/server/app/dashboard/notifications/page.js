(()=>{var e={};e.id=1654,e.ids=[1654],e.modules={3295:e=>{"use strict";e.exports=require("next/dist/server/app-render/after-task-async-storage.external.js")},5336:(e,s,t)=>{"use strict";t.d(s,{A:()=>i});let i=(0,t(62688).A)("CircleCheckBig",[["path",{d:"M21.801 10A10 10 0 1 1 17 3.335",key:"yps3ct"}],["path",{d:"m9 11 3 3L22 4",key:"1pflzl"}]])},10846:e=>{"use strict";e.exports=require("next/dist/compiled/next-server/app-page.runtime.prod.js")},12412:e=>{"use strict";e.exports=require("assert")},19121:e=>{"use strict";e.exports=require("next/dist/server/app-render/action-async-storage.external.js")},26861:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>i});let i=(0,t(12907).registerClientReference)(function(){throw Error("Attempted to call the default export of \"D:\\\\Project\\\\frontend\\\\app\\\\dashboard\\\\notifications\\\\page.tsx\" from the server, but it's on the client. It's not possible to invoke a client function from the server, it can only be rendered as a Component or passed to props of a Client Component.")},"D:\\Project\\frontend\\app\\dashboard\\notifications\\page.tsx","default")},27910:e=>{"use strict";e.exports=require("stream")},28354:e=>{"use strict";e.exports=require("util")},29021:e=>{"use strict";e.exports=require("fs")},29294:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-async-storage.external.js")},33873:e=>{"use strict";e.exports=require("path")},39529:(e,s,t)=>{Promise.resolve().then(t.bind(t,98561))},55511:e=>{"use strict";e.exports=require("crypto")},55591:e=>{"use strict";e.exports=require("https")},57678:(e,s,t)=>{"use strict";function i(){return null}t.r(s),t.d(s,{default:()=>i})},63033:e=>{"use strict";e.exports=require("next/dist/server/app-render/work-unit-async-storage.external.js")},69327:(e,s,t)=>{"use strict";t.d(s,{F:()=>n});var i=t(60687),a=t(43210),r=t(68123),l=t(96241);let n=a.forwardRef(({className:e,children:s,...t},a)=>(0,i.jsxs)(r.bL,{ref:a,className:(0,l.cn)("relative overflow-hidden",e),...t,children:[(0,i.jsx)(r.LM,{className:"h-full w-full rounded-[inherit]",children:s}),(0,i.jsx)(c,{}),(0,i.jsx)(r.OK,{})]}));n.displayName=r.bL.displayName;let c=a.forwardRef(({className:e,orientation:s="vertical",...t},a)=>(0,i.jsx)(r.VM,{ref:a,orientation:s,className:(0,l.cn)("flex touch-none select-none transition-colors","vertical"===s&&"h-full w-2.5 border-l border-l-transparent p-[1px]","horizontal"===s&&"h-2.5 flex-col border-t border-t-transparent p-[1px]",e),...t,children:(0,i.jsx)(r.lr,{className:"relative flex-1 rounded-full bg-border"})}));c.displayName=r.VM.displayName},74075:e=>{"use strict";e.exports=require("zlib")},74377:(e,s,t)=>{Promise.resolve().then(t.bind(t,26861))},79551:e=>{"use strict";e.exports=require("url")},81630:e=>{"use strict";e.exports=require("http")},85642:(e,s,t)=>{"use strict";t.r(s),t.d(s,{GlobalError:()=>l.a,__next_app__:()=>x,pages:()=>d,routeModule:()=>u,tree:()=>o});var i=t(65239),a=t(48088),r=t(88170),l=t.n(r),n=t(30893),c={};for(let e in n)0>["default","tree","pages","GlobalError","__next_app__","routeModule"].indexOf(e)&&(c[e]=()=>n[e]);t.d(s,c);let o={children:["",{children:["dashboard",{children:["notifications",{children:["__PAGE__",{},{page:[()=>Promise.resolve().then(t.bind(t,26861)),"D:\\Project\\frontend\\app\\dashboard\\notifications\\page.tsx"]}]},{loading:[()=>Promise.resolve().then(t.bind(t,57678)),"D:\\Project\\frontend\\app\\dashboard\\notifications\\loading.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,83249)),"D:\\Project\\frontend\\app\\dashboard\\layout.tsx"]}]},{layout:[()=>Promise.resolve().then(t.bind(t,58014)),"D:\\Project\\frontend\\app\\layout.tsx"],"not-found":[()=>Promise.resolve().then(t.t.bind(t,57398,23)),"next/dist/client/components/not-found-error"],forbidden:[()=>Promise.resolve().then(t.t.bind(t,89999,23)),"next/dist/client/components/forbidden-error"],unauthorized:[()=>Promise.resolve().then(t.t.bind(t,65284,23)),"next/dist/client/components/unauthorized-error"]}]}.children,d=["D:\\Project\\frontend\\app\\dashboard\\notifications\\page.tsx"],x={require:t,loadChunk:()=>Promise.resolve()},u=new i.AppPageRouteModule({definition:{kind:a.RouteKind.APP_PAGE,page:"/dashboard/notifications/page",pathname:"/dashboard/notifications",bundlePath:"",filename:"",appPaths:[]},userland:{loaderTree:o}})},94735:e=>{"use strict";e.exports=require("events")},95033:(e,s,t)=>{"use strict";t.d(s,{$v:()=>p,EO:()=>x,Lt:()=>c,Rx:()=>f,Zr:()=>j,ck:()=>m,r7:()=>h,wd:()=>u});var i=t(60687),a=t(43210),r=t(97895),l=t(96241),n=t(24934);let c=r.bL;r.l9;let o=r.ZL,d=a.forwardRef(({className:e,...s},t)=>(0,i.jsx)(r.hJ,{className:(0,l.cn)("fixed inset-0 z-50 bg-black/80  data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0",e),...s,ref:t}));d.displayName=r.hJ.displayName;let x=a.forwardRef(({className:e,...s},t)=>(0,i.jsxs)(o,{children:[(0,i.jsx)(d,{}),(0,i.jsx)(r.UC,{ref:t,className:(0,l.cn)("fixed left-[50%] top-[50%] z-50 grid w-full max-w-lg translate-x-[-50%] translate-y-[-50%] gap-4 border bg-background p-6 shadow-lg duration-200 data-[state=open]:animate-in data-[state=closed]:animate-out data-[state=closed]:fade-out-0 data-[state=open]:fade-in-0 data-[state=closed]:zoom-out-95 data-[state=open]:zoom-in-95 data-[state=closed]:slide-out-to-left-1/2 data-[state=closed]:slide-out-to-top-[48%] data-[state=open]:slide-in-from-left-1/2 data-[state=open]:slide-in-from-top-[48%] sm:rounded-lg",e),...s})]}));x.displayName=r.UC.displayName;let u=({className:e,...s})=>(0,i.jsx)("div",{className:(0,l.cn)("flex flex-col space-y-2 text-center sm:text-left",e),...s});u.displayName="AlertDialogHeader";let m=({className:e,...s})=>(0,i.jsx)("div",{className:(0,l.cn)("flex flex-col-reverse sm:flex-row sm:justify-end sm:space-x-2",e),...s});m.displayName="AlertDialogFooter";let h=a.forwardRef(({className:e,...s},t)=>(0,i.jsx)(r.hE,{ref:t,className:(0,l.cn)("text-lg font-semibold",e),...s}));h.displayName=r.hE.displayName;let p=a.forwardRef(({className:e,...s},t)=>(0,i.jsx)(r.VY,{ref:t,className:(0,l.cn)("text-sm text-muted-foreground",e),...s}));p.displayName=r.VY.displayName;let f=a.forwardRef(({className:e,...s},t)=>(0,i.jsx)(r.rc,{ref:t,className:(0,l.cn)((0,n.r)(),e),...s}));f.displayName=r.rc.displayName;let j=a.forwardRef(({className:e,...s},t)=>(0,i.jsx)(r.ZD,{ref:t,className:(0,l.cn)((0,n.r)({variant:"outline"}),"mt-2 sm:mt-0",e),...s}));j.displayName=r.ZD.displayName},98561:(e,s,t)=>{"use strict";t.r(s),t.d(s,{default:()=>M});var i=t(60687),a=t(43210),r=t(24934),l=t(68988),n=t(5336),c=t(62688);let o=(0,c.A)("TriangleAlert",[["path",{d:"m21.73 18-8-14a2 2 0 0 0-3.48 0l-8 14A2 2 0 0 0 4 21h16a2 2 0 0 0 1.73-3",key:"wmoenq"}],["path",{d:"M12 9v4",key:"juzpu7"}],["path",{d:"M12 17h.01",key:"p32p05"}]]),d=(0,c.A)("CircleX",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"m15 9-6 6",key:"1uzhvr"}],["path",{d:"m9 9 6 6",key:"z0biqf"}]]),x=(0,c.A)("Info",[["circle",{cx:"12",cy:"12",r:"10",key:"1mglay"}],["path",{d:"M12 16v-4",key:"1dtifu"}],["path",{d:"M12 8h.01",key:"e9boi3"}]]);var u=t(78122),m=t(96474),h=t(97051),p=t(99270),f=t(93661),j=t(13861),g=t(63143),N=t(88233),w=t(41862),b=t(96752),v=t(55629),y=t(59821),A=t(63974),C=t(55192),S=t(37826),k=t(39390),P=t(15616),E=t(26269),q=t(53723),_=t(69327),R=t(41312),T=t(12810);let F={getNotifications:async(e={})=>(await T.k.get("/push")).data,createNotification:async e=>(await T.k.post("/push/send",e)).data,updateNotification:async(e,s)=>(await T.k.put(`/admin/notifications/${e}`,s)).data,deleteNotification:async e=>(await T.k.delete(`/push/${e}`)).data,getStats:async()=>(await T.k.get("/push/stats")).data};t(34091);var D=t(71702);class U{constructor(){this.subscription=null,this.vapidPublicKey=process.env.NEXT_PUBLIC_VAPID_PUBLIC_KEY||""}async init(){if(!("serviceWorker"in navigator)||!("PushManager"in window))return console.warn("Push notifications not supported"),!1;try{let e=await navigator.serviceWorker.ready,s=await e.pushManager.getSubscription();if(s)return this.subscription=s,!0;return!1}catch(e){return console.error("Failed to initialize push notifications:",e),!1}}async subscribe(){if(!("serviceWorker"in navigator)||!("PushManager"in window))throw Error("Push notifications not supported");try{let e=await navigator.serviceWorker.ready,s=await e.pushManager.subscribe({userVisibleOnly:!0,applicationServerKey:this.urlBase64ToUint8Array(this.vapidPublicKey)});return this.subscription=s,await this.sendSubscriptionToServer(s),s}catch(e){throw console.error("Failed to subscribe to push notifications:",e),e}}async unsubscribe(){if(!this.subscription)return!0;try{let e=await this.subscription.unsubscribe();return e&&(await this.removeSubscriptionFromServer(),this.subscription=null),e}catch(e){return console.error("Failed to unsubscribe from push notifications:",e),!1}}async sendToUser(e,s){try{return(await T.A.post(`/push/user/${e}`,s)).data}catch(e){throw console.error("Failed to send push notification to user:",e),e}}async sendToAll(e){try{return(await T.A.post("/push/all",e)).data}catch(e){throw console.error("Failed to send push notification to all users:",e),e}}async sendToBatch(e,s){try{return(await T.A.post("/push/batch",{userIds:e,...s})).data}catch(e){throw console.error("Failed to send push notification to batch:",e),e}}async sendNotification(e){let{recipients:s,...t}=e;switch(s.type){case"all":return this.sendToAll(t);case"user":if(!s.userId)throw Error("User ID is required for user-specific notifications");return this.sendToUser(s.userId,t);case"batch":if(!s.userIds||0===s.userIds.length)throw Error("User IDs are required for batch notifications");return this.sendToBatch(s.userIds,t);default:throw Error("Invalid recipient type")}}getSubscription(){return this.subscription}isSupported(){return"serviceWorker"in navigator&&"PushManager"in window}async getPermission(){return"Notification"in window?Notification.permission:"denied"}async requestPermission(){return"Notification"in window?"default"===Notification.permission?await Notification.requestPermission():Notification.permission:"denied"}urlBase64ToUint8Array(e){let s="=".repeat((4-e.length%4)%4),t=(e+s).replace(/-/g,"+").replace(/_/g,"/"),i=window.atob(t),a=new Uint8Array(i.length);for(let e=0;e<i.length;++e)a[e]=i.charCodeAt(e);return a}async sendSubscriptionToServer(e){try{await T.A.post("/api/push/subscribe",{subscription:e})}catch(e){console.error("Failed to send subscription to server:",e)}}async removeSubscriptionFromServer(){try{await T.A.post("/api/push/unsubscribe")}catch(e){console.error("Failed to remove subscription from server:",e)}}}let I=new U;function L({open:e,onOpenChange:s,notification:t,mode:c,onSuccess:u}){let[m,p]=(0,a.useState)(!1),[f,j]=(0,a.useState)([]),[g,N]=(0,a.useState)([]),[b,v]=(0,a.useState)({title:"",message:"",type:"info",priority:"medium",recipients:{type:"all"},data:{url:""}}),[T,U]=(0,a.useState)(!1),{toast:L}=(0,D.dj)(),$=async e=>{if(e.preventDefault(),"view"!==c){if(!b.title.trim()||!b.message.trim()){L({title:"Error",description:"Title and message are required",variant:"destructive"});return}p(!0);try{let e={...b,recipients:{...b.recipients,userIds:"specific"===b.recipients.type?g:void 0},data:{url:b.data?.url||""}};if("create"===c?(await F.createNotification(e),L({title:"Success",description:"Notification created successfully"})):(await F.updateNotification(t._id,e),L({title:"Success",description:"Notification updated successfully"})),u?.(),s(!1),T)try{let e={title:b.title,message:b.message,type:b.type,priority:b.priority,data:{notificationId:t?._id||"new"}};"all"===b.recipients.type?await I.sendToAll(e):"specific"===b.recipients.type&&g.length>0&&await I.sendToBatch(g,e),L({title:"Success",description:"Push notification sent successfully"})}catch(e){console.error("Failed to send push notification:",e),L({title:"Warning",description:"Notification created but push notification failed",variant:"destructive"})}}catch(e){L({title:"Error",description:`Failed to ${c} notification`,variant:"destructive"}),console.error(`Error ${c}ing notification:`,e)}finally{p(!1)}}},M=(e,s)=>{s?N(s=>[...s,e]):N(s=>s.filter(s=>s!==e))};return(0,i.jsx)(S.lG,{open:e,onOpenChange:s,children:(0,i.jsxs)(S.Cf,{className:"max-w-4xl w-full max-w-full max-h-[90vh] bg-white dark:bg-slate-900 overflow-y-auto mx-2 sm:mx-auto rounded-xl p-2 sm:p-6",children:[(0,i.jsx)(S.c7,{children:(0,i.jsxs)(S.L3,{className:"flex items-center gap-2 text-lg sm:text-xl",children:[(0,i.jsx)(h.A,{className:"h-5 w-5"}),"create"===c?"Create Notification":"edit"===c?"Edit Notification":"Notification Details"]})}),(0,i.jsxs)("form",{onSubmit:$,className:"space-y-6",children:[(0,i.jsxs)(E.tU,{defaultValue:"content",className:"w-full",children:[(0,i.jsxs)(E.j7,{className:"grid w-full grid-cols-2 h-auto",children:[(0,i.jsx)(E.Xi,{value:"content",className:"text-xs sm:text-sm",children:"Content"}),(0,i.jsx)(E.Xi,{value:"recipients",className:"text-xs sm:text-sm",children:"Recipients"})]}),(0,i.jsxs)(E.av,{value:"content",className:"space-y-4 mt-4",children:[(0,i.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(k.J,{htmlFor:"title",className:"text-sm",children:"Title *"}),(0,i.jsx)(l.p,{id:"title",placeholder:"Enter notification title",value:b.title,onChange:e=>v({...b,title:e.target.value}),disabled:"view"===c,required:!0,className:"w-full"})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(k.J,{htmlFor:"type",className:"text-sm",children:"Type"}),(0,i.jsxs)(A.l6,{value:b.type,onValueChange:e=>v({...b,type:e}),disabled:"view"===c,children:[(0,i.jsx)(A.bq,{className:"w-full",children:(0,i.jsx)(A.yv,{})}),(0,i.jsxs)(A.gC,{children:[(0,i.jsx)(A.eb,{value:"info",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(x,{className:"h-4 w-4"}),"Info"]})}),(0,i.jsx)(A.eb,{value:"success",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(n.A,{className:"h-4 w-4"}),"Success"]})}),(0,i.jsx)(A.eb,{value:"warning",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(o,{className:"h-4 w-4"}),"Warning"]})}),(0,i.jsx)(A.eb,{value:"error",children:(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)(d,{className:"h-4 w-4"}),"Error"]})})]})]})]})]}),(0,i.jsxs)("div",{className:"grid grid-cols-1 sm:grid-cols-2 gap-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(k.J,{htmlFor:"priority",className:"text-sm",children:"Priority"}),(0,i.jsxs)(A.l6,{value:b.priority,onValueChange:e=>v({...b,priority:e}),disabled:"view"===c,children:[(0,i.jsx)(A.bq,{className:"w-full",children:(0,i.jsx)(A.yv,{})}),(0,i.jsxs)(A.gC,{children:[(0,i.jsx)(A.eb,{value:"low",children:"Low"}),(0,i.jsx)(A.eb,{value:"medium",children:"Medium"}),(0,i.jsx)(A.eb,{value:"high",children:"High"})]})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(k.J,{htmlFor:"expires",className:"text-sm",children:"Expires At (Optional)"}),(0,i.jsx)(l.p,{id:"expires",type:"datetime-local",value:b.expiresAt?new Date(b.expiresAt).toISOString().slice(0,16):"",onChange:e=>v({...b,expiresAt:e.target.value?new Date(e.target.value).toISOString():void 0}),disabled:"view"===c,className:"w-full"})]})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(k.J,{htmlFor:"message",className:"text-sm",children:"Message *"}),(0,i.jsx)(P.T,{id:"message",placeholder:"Enter notification message",value:b.message,onChange:e=>v({...b,message:e.target.value}),disabled:"view"===c,required:!0,rows:6,className:"w-full resize-none"})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(k.J,{htmlFor:"url",className:"text-sm",children:"URL (optional)"}),(0,i.jsx)(l.p,{id:"url",placeholder:"Enter URL (e.g. /tabs/series)",value:b.data?.url||"",onChange:e=>v({...b,data:{...b.data,url:e.target.value}}),disabled:"view"===c,className:"w-full"}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"This URL will be sent with the notification data."})]}),"view"===c&&t&&(0,i.jsxs)(C.Zp,{children:[(0,i.jsx)(C.aR,{children:(0,i.jsx)(C.ZB,{className:"text-lg",children:"Preview"})}),(0,i.jsx)(C.Wu,{children:(0,i.jsx)("div",{className:`p-4 rounded-lg border ${(e=>{switch(e){case"success":return"bg-green-100 text-green-800 border-green-200";case"warning":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"error":return"bg-red-100 text-red-800 border-red-200";default:return"bg-blue-100 text-blue-800 border-blue-200"}})(t.type)}`,children:(0,i.jsxs)("div",{className:"flex items-start gap-3",children:[(e=>{switch(e){case"success":return(0,i.jsx)(n.A,{className:"h-4 w-4"});case"warning":return(0,i.jsx)(o,{className:"h-4 w-4"});case"error":return(0,i.jsx)(d,{className:"h-4 w-4"});default:return(0,i.jsx)(x,{className:"h-4 w-4"})}})(t.type),(0,i.jsxs)("div",{className:"flex-1",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2 mb-2",children:[(0,i.jsx)("h4",{className:"font-medium",children:t.title}),(0,i.jsx)(y.E,{className:(e=>{switch(e){case"high":return"bg-red-100 text-red-800 border-red-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-green-100 text-green-800 border-green-200"}})(t.priority),children:t.priority})]}),(0,i.jsx)("p",{className:"text-sm",children:t.message}),(0,i.jsxs)("div",{className:"flex items-center gap-4 mt-2 text-xs text-muted-foreground",children:[(0,i.jsxs)("span",{children:["From: ",t.sender.name]}),(0,i.jsx)("span",{children:new Date(t.createdAt).toLocaleString()})]})]})]})})})]})]}),(0,i.jsx)(E.av,{value:"recipients",className:"space-y-4 mt-4",children:(0,i.jsxs)(C.Zp,{children:[(0,i.jsxs)(C.aR,{children:[(0,i.jsxs)(C.ZB,{className:"flex items-center gap-2 text-lg",children:[(0,i.jsx)(R.A,{className:"h-5 w-5"}),"Select Recipients"]}),(0,i.jsx)(C.BT,{className:"text-sm",children:"Choose who will receive this notification"})]}),(0,i.jsxs)(C.Wu,{className:"space-y-4",children:[(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(k.J,{className:"text-sm",children:"Recipient Type"}),(0,i.jsxs)(A.l6,{value:b.recipients.type,onValueChange:e=>v({...b,recipients:{...b.recipients,type:e}}),disabled:"view"===c,children:[(0,i.jsx)(A.bq,{className:"w-full",children:(0,i.jsx)(A.yv,{})}),(0,i.jsxs)(A.gC,{children:[(0,i.jsx)(A.eb,{value:"all",children:"All Users"}),(0,i.jsx)(A.eb,{value:"role",children:"By Role"}),(0,i.jsx)(A.eb,{value:"specific",children:"Specific Users"})]})]})]}),"role"===b.recipients.type&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsx)(k.J,{className:"text-sm",children:"Select Roles"}),(0,i.jsx)("div",{className:"grid grid-cols-2 sm:grid-cols-4 gap-2",children:["admin","teacher","student","user"].map(e=>(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(q.S,{id:e,checked:b.recipients.roles?.includes(e)||!1,onCheckedChange:s=>{let t=b.recipients.roles||[],i=s?[...t,e]:t.filter(s=>s!==e);v({...b,recipients:{...b.recipients,roles:i}})},disabled:"view"===c}),(0,i.jsx)(k.J,{htmlFor:e,className:"text-sm capitalize",children:e})]},e))})]}),"specific"===b.recipients.type&&(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)(k.J,{className:"text-sm",children:["Select Users (",g.length," selected)"]}),(0,i.jsx)(_.F,{className:"h-64 border rounded-md p-2 sm:p-4",children:(0,i.jsx)("div",{className:"space-y-2",children:f.map(e=>(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(q.S,{id:e._id,checked:g.includes(e._id),onCheckedChange:s=>M(e._id,s),disabled:"view"===c}),(0,i.jsxs)(k.J,{htmlFor:e._id,className:"flex-1 text-sm",children:[(0,i.jsxs)("div",{className:"flex items-center gap-2",children:[(0,i.jsx)("span",{children:e.name}),(0,i.jsx)(y.E,{variant:"outline",className:"text-xs",children:e.role})]}),(0,i.jsx)("div",{className:"text-xs text-muted-foreground",children:e.email})]})]},e._id))})})]}),(0,i.jsxs)("div",{className:"space-y-2",children:[(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(q.S,{id:"pushNotification",checked:T,onCheckedChange:e=>U(e),disabled:"view"===c}),(0,i.jsx)(k.J,{htmlFor:"pushNotification",className:"text-sm",children:"Send as push notification"})]}),(0,i.jsx)("p",{className:"text-xs text-muted-foreground",children:"Users will receive a real-time push notification on their devices"})]}),"view"===c&&t&&(0,i.jsxs)("div",{className:"mt-4 p-4 bg-muted rounded-lg",children:[(0,i.jsx)("h4",{className:"font-medium mb-2",children:"Recipients Summary"}),(0,i.jsxs)("div",{className:"text-sm text-muted-foreground",children:["all"===t.recipients.type&&"All users will receive this notification","role"===t.recipients.type&&`Users with roles: ${t.recipients.roles?.join(", ")}`,"specific"===t.recipients.type&&`${t.recipients.userIds?.length||0} specific users selected`]})]})]})]})})]}),(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row justify-end gap-2 pt-4 border-t",children:[(0,i.jsx)(r.$,{type:"button",variant:"outline",onClick:()=>s(!1),className:"w-full sm:w-auto",children:"view"===c?"Close":"Cancel"}),"view"!==c&&(0,i.jsxs)(r.$,{type:"submit",disabled:m,className:"w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white",children:[m&&(0,i.jsx)(w.A,{className:"h-4 w-4 mr-2 animate-spin"}),"create"===c?"Create Notification":"Update Notification"]})]})]})]})})}var $=t(95033);function M(){let[e,s]=(0,a.useState)([]),[t,c]=(0,a.useState)(!0),[S,k]=(0,a.useState)(""),[P,E]=(0,a.useState)("all"),[q,_]=(0,a.useState)("all"),[R,T]=(0,a.useState)(!1),[U,I]=(0,a.useState)("create"),[M,z]=(0,a.useState)(null),[B,Z]=(0,a.useState)(!1),[J,W]=(0,a.useState)(null),[V,O]=(0,a.useState)(!1),[H,K]=(0,a.useState)({total:0,active:0,byType:{},byPriority:{}}),[X,G]=(0,a.useState)({page:1,limit:10,total:0}),{toast:Y}=(0,D.dj)(),Q=async()=>{c(!0);try{let e=await F.getNotifications({page:X.page,limit:X.limit,type:"all"===P?void 0:P,priority:"all"===q?void 0:q}),t=e.notifications;S&&(t=e.notifications.filter(e=>e.title.toLowerCase().includes(S.toLowerCase())||e.message.toLowerCase().includes(S.toLowerCase()))),s(t),G(s=>({...s,total:e.total}))}catch(e){Y({title:"Error",description:"Failed to fetch notifications",variant:"destructive"}),console.error("Error fetching notifications:",e)}finally{c(!1)}},ee=async()=>{try{let e=await F.getStats();K(e)}catch(e){console.error("Error fetching stats:",e)}},es=e=>{z(e),I("view"),T(!0)},et=e=>{z(e),I("edit"),T(!0)},ei=e=>{W(e),Z(!0)},ea=async()=>{if(J){O(!0);try{await F.deleteNotification(J._id),Y({title:"Success",description:"Notification deleted successfully"}),Q(),ee()}catch(e){Y({title:"Error",description:"Failed to delete notification",variant:"destructive"}),console.error("Error deleting notification:",e)}finally{O(!1),Z(!1),W(null)}}},er=e=>{switch(e){case"success":return(0,i.jsx)(n.A,{className:"h-4 w-4"});case"warning":return(0,i.jsx)(o,{className:"h-4 w-4"});case"error":return(0,i.jsx)(d,{className:"h-4 w-4"});default:return(0,i.jsx)(x,{className:"h-4 w-4"})}},el=e=>{switch(e){case"success":return"bg-green-100 text-green-800 border-green-200";case"warning":return"bg-yellow-100 text-yellow-800 border-yellow-200";case"error":return"bg-red-100 text-red-800 border-red-200";default:return"bg-blue-100 text-blue-800 border-blue-200"}},en=e=>{switch(e){case"high":return"bg-red-100 text-red-800 border-red-200";case"medium":return"bg-yellow-100 text-yellow-800 border-yellow-200";default:return"bg-green-100 text-green-800 border-green-200"}},ec=e=>{switch(e.type){case"all":return"All Users";case"role":return`Roles: ${e.roles?.join(", ")||"None"}`;case"specific":return`${e.userIds?.length||0} Users`;default:return"Unknown"}},eo=Math.ceil(X.total/X.limit);return(0,i.jsxs)("div",{className:"space-y-6 p-4 sm:p-6",children:[(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row items-start sm:items-center justify-between gap-4",children:[(0,i.jsxs)("div",{children:[(0,i.jsx)("h2",{className:"text-2xl sm:text-3xl font-bold tracking-tight",children:"Notification Center"}),(0,i.jsx)("p",{className:"text-muted-foreground text-sm sm:text-base",children:"Send and manage notifications to users"})]}),(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row gap-2 w-full sm:w-auto",children:[(0,i.jsxs)(r.$,{variant:"outline",onClick:Q,disabled:t,className:"w-full sm:w-auto bg-transparent",children:[(0,i.jsx)(u.A,{className:`mr-2 h-4 w-4 ${t?"animate-spin":""}`}),"Refresh"]}),(0,i.jsxs)(r.$,{onClick:()=>{z(null),I("create"),T(!0)},className:"w-full sm:w-auto bg-blue-600 hover:bg-blue-700 text-white",children:[(0,i.jsx)(m.A,{className:"mr-2 h-4 w-4"}),"Create Notification"]})]})]}),(0,i.jsxs)("div",{className:"grid gap-4 grid-cols-2 lg:grid-cols-4",children:[(0,i.jsxs)(C.Zp,{children:[(0,i.jsxs)(C.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,i.jsx)(C.ZB,{className:"text-sm font-medium",children:"Total"}),(0,i.jsx)(h.A,{className:"h-4 w-4 text-muted-foreground"})]}),(0,i.jsx)(C.Wu,{children:(0,i.jsx)("div",{className:"text-xl sm:text-2xl font-bold",children:H.total})})]}),(0,i.jsxs)(C.Zp,{children:[(0,i.jsxs)(C.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,i.jsx)(C.ZB,{className:"text-sm font-medium",children:"Active"}),(0,i.jsx)(n.A,{className:"h-4 w-4 text-green-600"})]}),(0,i.jsx)(C.Wu,{children:(0,i.jsx)("div",{className:"text-xl sm:text-2xl font-bold",children:H.active})})]}),(0,i.jsxs)(C.Zp,{children:[(0,i.jsxs)(C.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,i.jsx)(C.ZB,{className:"text-sm font-medium",children:"High Priority"}),(0,i.jsx)(o,{className:"h-4 w-4 text-red-600"})]}),(0,i.jsx)(C.Wu,{children:(0,i.jsx)("div",{className:"text-xl sm:text-2xl font-bold",children:H.byPriority.high||0})})]}),(0,i.jsxs)(C.Zp,{children:[(0,i.jsxs)(C.aR,{className:"flex flex-row items-center justify-between space-y-0 pb-2",children:[(0,i.jsx)(C.ZB,{className:"text-sm font-medium",children:"Errors"}),(0,i.jsx)(d,{className:"h-4 w-4 text-red-600"})]}),(0,i.jsx)(C.Wu,{children:(0,i.jsx)("div",{className:"text-xl sm:text-2xl font-bold",children:H.byType.error||0})})]})]}),(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row items-stretch sm:items-center gap-2",children:[(0,i.jsxs)("div",{className:"relative flex-1 max-w-sm",children:[(0,i.jsx)(p.A,{className:"absolute left-2.5 top-2.5 h-4 w-4 text-muted-foreground"}),(0,i.jsx)(l.p,{placeholder:"Search notifications...",value:S,onChange:e=>k(e.target.value),className:"pl-8"})]}),(0,i.jsxs)(A.l6,{value:P,onValueChange:E,children:[(0,i.jsx)(A.bq,{className:"w-full sm:w-[150px]",children:(0,i.jsx)(A.yv,{placeholder:"Type"})}),(0,i.jsxs)(A.gC,{children:[(0,i.jsx)(A.eb,{value:"all",children:"All Types"}),(0,i.jsx)(A.eb,{value:"info",children:"Info"}),(0,i.jsx)(A.eb,{value:"success",children:"Success"}),(0,i.jsx)(A.eb,{value:"warning",children:"Warning"}),(0,i.jsx)(A.eb,{value:"error",children:"Error"})]})]}),(0,i.jsxs)(A.l6,{value:q,onValueChange:_,children:[(0,i.jsx)(A.bq,{className:"w-full sm:w-[150px]",children:(0,i.jsx)(A.yv,{placeholder:"Priority"})}),(0,i.jsxs)(A.gC,{children:[(0,i.jsx)(A.eb,{value:"all",children:"All Priorities"}),(0,i.jsx)(A.eb,{value:"low",children:"Low"}),(0,i.jsx)(A.eb,{value:"medium",children:"Medium"}),(0,i.jsx)(A.eb,{value:"high",children:"High"})]})]})]}),(0,i.jsx)("div",{className:"rounded-md border overflow-hidden",children:(0,i.jsx)("div",{className:"overflow-x-auto",children:(0,i.jsxs)(b.XI,{children:[(0,i.jsx)(b.A0,{children:(0,i.jsxs)(b.Hj,{children:[(0,i.jsx)(b.nd,{className:"min-w-[200px]",children:"Title"}),(0,i.jsx)(b.nd,{className:"hidden sm:table-cell",children:"Type"}),(0,i.jsx)(b.nd,{className:"hidden md:table-cell",children:"Priority"}),(0,i.jsx)(b.nd,{className:"hidden lg:table-cell",children:"Recipients"}),(0,i.jsx)(b.nd,{className:"hidden sm:table-cell",children:"Created"}),(0,i.jsx)(b.nd,{className:"text-right",children:"Actions"})]})}),(0,i.jsx)(b.BF,{children:t?Array.from({length:5}).map((e,s)=>(0,i.jsxs)(b.Hj,{children:[(0,i.jsx)(b.nA,{children:(0,i.jsx)("div",{className:"h-4 w-32 bg-muted animate-pulse rounded"})}),(0,i.jsx)(b.nA,{className:"hidden sm:table-cell",children:(0,i.jsx)("div",{className:"h-4 w-16 bg-muted animate-pulse rounded"})}),(0,i.jsx)(b.nA,{className:"hidden md:table-cell",children:(0,i.jsx)("div",{className:"h-4 w-16 bg-muted animate-pulse rounded"})}),(0,i.jsx)(b.nA,{className:"hidden lg:table-cell",children:(0,i.jsx)("div",{className:"h-4 w-20 bg-muted animate-pulse rounded"})}),(0,i.jsx)(b.nA,{className:"hidden sm:table-cell",children:(0,i.jsx)("div",{className:"h-4 w-20 bg-muted animate-pulse rounded"})}),(0,i.jsx)(b.nA,{children:(0,i.jsx)("div",{className:"h-4 w-8 bg-muted animate-pulse rounded ml-auto"})})]},s)):0===e.length?(0,i.jsx)(b.Hj,{children:(0,i.jsxs)(b.nA,{colSpan:6,className:"text-center py-8",children:[(0,i.jsx)(h.A,{className:"h-12 w-12 mx-auto mb-4 text-muted-foreground"}),(0,i.jsx)("p",{className:"text-muted-foreground",children:"No notifications found"})]})}):e.map(e=>(0,i.jsxs)(b.Hj,{children:[(0,i.jsxs)(b.nA,{className:"min-w-[200px]",children:[(0,i.jsx)("div",{className:"font-medium truncate",title:e.title,children:e.title}),(0,i.jsx)("div",{className:"text-xs text-muted-foreground truncate mt-1 sm:hidden",children:e.message})]}),(0,i.jsx)(b.nA,{className:"hidden sm:table-cell",children:(0,i.jsx)(y.E,{className:`${el(e.type)} text-xs`,children:(0,i.jsxs)("div",{className:"flex items-center gap-1",children:[er(e.type),(0,i.jsx)("span",{className:"capitalize",children:e.type})]})})}),(0,i.jsx)(b.nA,{className:"hidden md:table-cell",children:(0,i.jsx)(y.E,{className:`${en(e.priority)} text-xs`,children:e.priority.charAt(0).toUpperCase()+e.priority.slice(1)})}),(0,i.jsx)(b.nA,{className:"hidden lg:table-cell",children:(0,i.jsx)("div",{className:"text-sm",children:ec(e.recipients)})}),(0,i.jsx)(b.nA,{className:"hidden sm:table-cell",children:(0,i.jsx)("div",{className:"text-sm",children:new Date(e.createdAt).toLocaleDateString()})}),(0,i.jsx)(b.nA,{className:"text-right",children:(0,i.jsxs)(v.rI,{children:[(0,i.jsx)(v.ty,{asChild:!0,children:(0,i.jsx)(r.$,{variant:"ghost",className:"h-8 w-8 p-0",children:(0,i.jsx)(f.A,{className:"h-4 w-4"})})}),(0,i.jsxs)(v.SQ,{align:"end",children:[(0,i.jsxs)(v._2,{onClick:()=>es(e),children:[(0,i.jsx)(j.A,{className:"mr-2 h-4 w-4"}),"View Details"]}),(0,i.jsxs)(v._2,{onClick:()=>et(e),children:[(0,i.jsx)(g.A,{className:"mr-2 h-4 w-4"}),"Edit"]}),(0,i.jsxs)(v._2,{className:"text-red-600",onClick:()=>ei(e),children:[(0,i.jsx)(N.A,{className:"mr-2 h-4 w-4"}),"Delete"]})]})]})})]},e._id))})]})})}),eo>1&&(0,i.jsxs)("div",{className:"flex flex-col sm:flex-row items-center justify-between gap-4",children:[(0,i.jsxs)("p",{className:"text-sm text-muted-foreground text-center sm:text-left",children:["Showing ",(X.page-1)*X.limit+1," to"," ",Math.min(X.page*X.limit,X.total)," of ",X.total," notifications"]}),(0,i.jsxs)("div",{className:"flex items-center space-x-2",children:[(0,i.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>G(e=>({...e,page:e.page-1})),disabled:1===X.page,children:"Previous"}),(0,i.jsxs)("span",{className:"text-sm",children:["Page ",X.page," of ",eo]}),(0,i.jsx)(r.$,{variant:"outline",size:"sm",onClick:()=>G(e=>({...e,page:e.page+1})),disabled:X.page===eo,children:"Next"})]})]}),(0,i.jsx)(L,{open:R,onOpenChange:T,notification:M,mode:U,onSuccess:()=>{Q(),ee()}}),(0,i.jsx)($.Lt,{open:B,onOpenChange:Z,children:(0,i.jsxs)($.EO,{className:"mx-4 sm:mx-auto",children:[(0,i.jsxs)($.wd,{children:[(0,i.jsx)($.r7,{children:"Are you sure?"}),(0,i.jsxs)($.$v,{children:['This action cannot be undone. This will permanently delete the notification "',J?.title,'".']})]}),(0,i.jsxs)($.ck,{className:"flex-col sm:flex-row gap-2",children:[(0,i.jsx)($.Zr,{disabled:V,className:"w-full sm:w-auto",children:"Cancel"}),(0,i.jsxs)($.Rx,{onClick:ea,disabled:V,className:"w-full sm:w-auto bg-red-600 hover:bg-red-700",children:[V&&(0,i.jsx)(w.A,{className:"mr-2 h-4 w-4 animate-spin"}),V?"Deleting...":"Delete"]})]})]})})]})}}};var s=require("../../../webpack-runtime.js");s.C(e);var t=e=>s(s.s=e),i=s.X(0,[4447,1195,8405,4492,6954,4821,4802,2525,9699],()=>t(85642));module.exports=i})();